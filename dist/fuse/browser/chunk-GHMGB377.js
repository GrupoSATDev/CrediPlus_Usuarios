import{a as Ne,b as Ie,c as Ge,d as Te}from"./chunk-Y4MQD3WA.js";import{a as Ae}from"./chunk-QHKOCQQB.js";import{a as Ve}from"./chunk-5YZJEQ6Q.js";import{a as Fe}from"./chunk-Z2MQWE4K.js";import{a as Ee,b as De}from"./chunk-3JFTCLCY.js";import{a as we}from"./chunk-7MXP3OLL.js";import{a as xe}from"./chunk-J6NPCFJ2.js";import{a as Se,b as _e}from"./chunk-2RSQTUPN.js";import{a as ye}from"./chunk-OFEOPKCC.js";import{a as he}from"./chunk-KQASFADC.js";import{g as ie}from"./chunk-QS2WZY2K.js";import"./chunk-JND367CQ.js";import{h as Y}from"./chunk-7U4JZNVG.js";import{a as be}from"./chunk-CH3XODOV.js";import"./chunk-ZFQVSUZG.js";import{A as ce,C as fe,E as Ce,F as ve,J as ge,b as Z,c as ee,i as te,l as ne,n as v,p as ae,q as me,u as le,v as de,x as pe,y as se,z as ue}from"./chunk-K2P4EKGI.js";import{$ as X,Q as K,R as U,ea as oe}from"./chunk-DARKUWJB.js";import{a as re}from"./chunk-75YALSW6.js";import"./chunk-EENLYY7H.js";import"./chunk-WGGS5SGH.js";import{d as H}from"./chunk-DJAHQBBJ.js";import{e as L,f as Q,g as W,i as z,j as w,l as J}from"./chunk-NP3GUERB.js";import{Cb as o,Db as e,Eb as u,Fb as _,Gb as F,Ib as q,Ob as E,Qb as I,Ub as k,Vb as P,Wb as O,Yb as r,Za as t,Zb as f,_b as G,dc as R,ec as $,fa as c,hc as j,ka as V,l as D,mc as g,na as M,nc as x,oc as B,pb as s,rb as a,ua as S,va as y}from"./chunk-32HXX3OB.js";import{a as N,d as A}from"./chunk-NEB6MB4Y.js";var T=(()=>{let m=class m{transform(p){return`${p.numCredito} - ${new Date(p.fechaAprobacion).toLocaleDateString("es-ES")}`}};m.\u0275fac=function(l){return new(l||m)},m.\u0275pipe=M({name:"formatoOptions",type:m,pure:!0,standalone:!0});let i=m;return i})();var Oe=["stepper"],Re=(i,m)=>({"bg-crediblue-50":i,"bg-credigray-100":m});function $e(i,m){if(i&1&&(o(0,"mat-option",37),r(1),e()),i&2){let d=m.$implicit;a("value",d.id),t(),f(d.nombre)}}function je(i,m){if(i&1&&(_(0),s(1,$e,2,2,"mat-option",36),F()),i&2){let d=m.ngIf;t(),a("ngForOf",d.data)}}function Be(i,m){i&1&&(o(0,"mat-error"),r(1," El tipo de documento es requerido!. "),e())}function Le(i,m){i&1&&(o(0,"mat-error"),r(1," El n\xFAmero de identificaci\xF3n es requerido!. "),e())}function Qe(i,m){if(i&1&&(o(0,"fuse-alert",38),r(1),e()),i&2){let d=I();a("appearance","outline")("showIcon",!1)("type",d.alert.type)("@shake",d.alert.type==="error"),t(),G(" ",d.alert.message," ")}}function We(i,m){if(i&1&&(_(0),o(1,"mat-option",37),r(2),g(3,"formatoOptions"),e(),F()),i&2){let d=m.$implicit;t(),a("value",d),t(),f(x(3,2,d))}}function ze(i,m){i&1&&(o(0,"mat-error"),r(1,"El valor es requerido!"),e())}function Je(i,m){i&1&&(o(0,"mat-error"),r(1,"El valor ingresado no puede superar el cupo disponible!"),e())}function He(i,m){if(i&1&&(o(0,"mat-option",37),r(1),e()),i&2){let d=m.$implicit;a("value",d.id),t(),f(d.nombre)}}function Ke(i,m){if(i&1&&(_(0),s(1,He,2,2,"mat-option",36),F()),i&2){let d=m.ngIf;t(),a("ngForOf",d.data)}}function Ue(i,m){if(i&1&&(o(0,"mat-option",37),r(1),e()),i&2){let d=m.$implicit;a("value",d.id),t(),f(d.nombre)}}function Xe(i,m){if(i&1&&(_(0),s(1,Ue,2,2,"mat-option",36),F()),i&2){let d=m.ngIf;t(),a("ngForOf",d.data)}}function Ye(i,m){if(i&1&&(o(0,"div",17)(1,"div",39)(2,"div",40)(3,"h2",41),r(4,"Resumen de la Compra"),e(),o(5,"p",42),r(6,"Revise los detalles"),e()(),o(7,"div",43)(8,"div",44)(9,"div")(10,"h3",45),r(11,"Fecha de compra"),e()(),o(12,"p",46),r(13),g(14,"date"),e()(),o(15,"div",44)(16,"div")(17,"h3",45),r(18,"N\xFAmero de factura"),e()(),o(19,"p",46),r(20),e()(),o(21,"div",44)(22,"div")(23,"h3",45),r(24,"Valor $"),e(),o(25,"p",42),r(26,"Indica el valor en COP"),e()(),o(27,"p",46),r(28),g(29,"currency"),e()(),o(30,"div",47)(31,"p",45),r(32,"N\xFAmero de cuotas"),e(),o(33,"p",46),r(34),e()(),o(35,"div",48)(36,"p",45),r(37,"Estado"),e(),o(38,"p",46),r(39),e()(),o(40,"div",49)(41,"p",45),r(42,"Detalle compra"),e(),o(43,"p",46),r(44),e()()(),o(45,"div",50)(46,"button",51),r(47," Recargar "),e()()()()),i&2){let d=I();t(13),f(B(14,6,d.detaleConsumo.fechaCreacion,"dd/MM/yyyy")),t(7),f(d.detaleConsumo.numeroFactura),t(8),f(x(29,9,d.detaleConsumo.montoConsumo)),t(6),f(d.detaleConsumo.cantidadCuotas),t(5),f(d.detaleConsumo.nombreEstadoCredito),t(5),f(d.detaleConsumo.detalleCompra)}}var Ze={validation:!1},Me=(()=>{let m=class m{constructor(){this.tiposDocumentosService=c(we),this.fuseService=c(ie),this.estadosDatosService=c(ye),this.toasService=c(_e),this.empleadosServices=c(Ae),this.datePipe=c(w),this.router=c(H),this.fb=c(fe),this._locacionService=c(xe),this.detalleConsumo=c(Ve),this.departamentos$=this._locacionService.getDepartamentos(),this.showAlert=!1,this.alert={type:"success",message:""},this.tiposDocumentos$=this.tiposDocumentosService.getTiposDocumentos(),this.creditos=[],this.focus=focus,this.FormatoOptionsPipe=T}ngOnDestroy(){}ngOnInit(){this.createForm()}getMunicipios(p){let l=p.value;this.municipios$=this._locacionService.getMunicipio(l)}selected(p){let l=p.value;this.compareValor=l.cupoDisponible,this.thirdFormGroup.get("montoConsumo").setValidators(et(this.compareValor)),this.thirdFormGroup.get("montoConsumo").updateValueAndValidity()}compareWithConstants(p){let l=p.value,n=this.secondFormGroup.get("idCredito")?.value;return!n||!n.montoConsumo?(console.error("No se encontr\xF3 el objeto idCredito o montoConsumo"),D(null)):(console.log(l),console.log(n.montoConsumo),l>n.montoConsumo?D({notEqual:!0}):D(null))}get montoConsumo(){return this.thirdFormGroup.get("montoConsumo")}onSearch(){let p=this.firstFormGroup.getRawValue();this.empleadosServices.getEmpleadoParams(p).subscribe(l=>{if(console.log(l),l){this.showAlert=!1;let n={numDoc:l.data.numDoc,primerNombre:l.data.primerNombre,segundoNombre:l.data.segundoNombre,primerApellido:l.data.primerApellido,segundoApellido:l.data.segundoApellido,idTrabajador:l.data.id,correo:l.data.correo};this.secondFormGroup.patchValue(n),this.creditos=l.data.creditos,setTimeout(()=>{this.stepper.next()},1200)}},l=>{this.alert={type:"error",message:"El empleado no existe!"},this.showAlert=!0})}onSave(){if(this.thirdFormGroup.valid){let p=this.thirdFormGroup.getRawValue(),{montoConsumo:l}=p,n=A(p,["montoConsumo"]),{idCredito:C,idTrabajador:b}=this.secondFormGroup.getRawValue();console.log(C);let h=N({idCredito:C.id,idTrabajador:b,montoConsumo:Number(l)},n);console.log(h),this.fuseService.open(N({},Se)).afterClosed().subscribe(qe=>{qe==="confirmed"&&this.detalleConsumo.postDetalle(h).subscribe(ke=>{console.log(ke),this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.getResumenCompra(b)})})}}getResumenCompra(p){this.subscription$=this.detalleConsumo.getResumen(p).subscribe(l=>{l&&(console.log(l),this.detaleConsumo=l.data,this.stepper.next())})}createForm(){this.firstFormGroup=this.fb.group({idTipoDoc:["",v.required],numDocumento:["",v.required]}),this.secondFormGroup=this.fb.group({numDoc:[{value:"",disabled:!0}],primerNombre:[{value:"",disabled:!0}],segundoNombre:[{value:"",disabled:!0}],primerApellido:[{value:"",disabled:!0}],segundoApellido:[{value:"",disabled:!0}],idTrabajador:[""],correo:[{value:"",disabled:!0}],idCredito:["",v.required]}),this.thirdFormGroup=this.fb.group({cantidadCuotas:["",[v.required]],montoConsumo:["",[v.required]],numeroFactura:["",v.required],detalleCompra:["",v.required],idMunicipio:["",v.required]})}};m.\u0275fac=function(l){return new(l||m)},m.\u0275cmp=V({type:m,selectors:[["app-form-detalle-consumo"]],viewQuery:function(l,n){if(l&1&&k(Oe,5),l&2){let C;P(C=O())&&(n.stepper=C.first)}},standalone:!0,features:[R([{provide:U,useClass:Fe},{provide:K,useValue:"en-GB"},w,Ee(Ze)]),$],decls:111,vars:55,consts:[["stepper",""],["data",""],["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"sm:bg-card","sm:rounded-2xl","sm:mx-0","mx-auto","overflow-hidden"],[1,"mt-8","text-3xl","font-semibold","leading-tight","tracking-tight","text-center"],[3,"linear"],["label","Consultar empleado",3,"stepControl"],[1,"flex","flex-col","items-center","justify-center","w-full","h-full","px-4"],[3,"formGroup"],[1,"w-full"],[3,"formControlName"],[4,"ngIf"],["matInput","","placeholder","Ingrese identificaci\xF3n",3,"formControlName"],["class","mb-4",3,"appearance","showIcon","type",4,"ngIf"],["mat-raised-button","",1,"text-white","px-6","py-2","rounded-md","w-full",3,"click","disabled","ngClass"],["label","Verificar informaci\xF3n",3,"stepControl"],[1,"w-full","h-full","px-4"],[1,"flex","flex-row","gap-2.5"],["matInput","",3,"formControlName","disabled"],[1,"flex","flex-row"],[3,"selectionChange","formControlName"],[4,"ngFor","ngForOf"],[1,"flex","justify-end","gap-2.5"],["mat-button","","matStepperPrevious","",1,"bg-gray-500","text-white","py-2","px-4","rounded","hover:bg-gray-600"],["mat-button","","matStepperNext","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded",3,"disabled"],["label","Completar compra",3,"stepControl"],[1,"flex","flex-row","items-baseline","gap-2.5"],["matInput","",3,"formControlName"],["matInput","","thousandSeparator",".",3,"formControlName","mask"],["matInput","","type","number",3,"min","max","formControlName"],[3,"selectionChange"],["matInput","","placeholder","Detalle",3,"formControlName"],["mat-button","",1,"bg-crediblue-50","text-white","py-2","px-4","rounded",3,"click","disabled"],["label","Resumen de compra",3,"stepControl"],["class","w-full h-full px-4",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mb-4",3,"appearance","showIcon","type"],[1,"max-w-2xl","mx-auto","p-4","bg-white","shadow-lg","rounded-lg"],[1,"border-b","pb-4","mb-4"],[1,"text-2xl","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"flex","justify-between","items-center","pt-4","border-t"],[1,"flex","justify-between","items-center"],[1,"flex","justify-between","items-center","border-t","pt-4"],[1,"mt-6"],[1,"w-full","bg-crediblue-50","text-white","py-2","px-4","rounded-lg"]],template:function(l,n){if(l&1){let C=q();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5),r(4),e(),o(5,"mat-horizontal-stepper",6,0)(7,"mat-step",7)(8,"div",8)(9,"form",9)(10,"mat-form-field",10)(11,"mat-label"),r(12,"Tipo de documento"),e(),o(13,"mat-select",11),s(14,je,2,1,"ng-container",12),g(15,"async"),e(),s(16,Be,2,0,"mat-error",12),e(),o(17,"mat-form-field",10)(18,"mat-label"),r(19,"N\xFAmero de identificaci\xF3n"),e(),u(20,"input",13),s(21,Le,2,0,"mat-error",12),e(),s(22,Qe,2,5,"fuse-alert",14),o(23,"button",15),E("click",function(){return S(C),y(n.onSearch())}),r(24,"Consultar"),e()()()(),o(25,"mat-step",16)(26,"div",17)(27,"form",9)(28,"div",18)(29,"mat-form-field",10)(30,"mat-label"),r(31,"Primer nombre"),e(),u(32,"input",19),e(),o(33,"mat-form-field",10)(34,"mat-label"),r(35,"Segundo nombre"),e(),u(36,"input",19),e()(),o(37,"div",18)(38,"mat-form-field",10)(39,"mat-label"),r(40,"Primer apellido"),e(),u(41,"input",19),e(),o(42,"mat-form-field",10)(43,"mat-label"),r(44,"Segundo apellido"),e(),u(45,"input",19),e()(),o(46,"div",18)(47,"mat-form-field",10)(48,"mat-label"),r(49,"Identificaci\xF3n"),e(),u(50,"input",19),e(),o(51,"mat-form-field",10)(52,"mat-label"),r(53,"Email"),e(),u(54,"input",19),e()(),o(55,"div",20)(56,"mat-form-field",10)(57,"mat-label"),r(58,"Cr\xE9ditos"),e(),o(59,"mat-select",21),E("selectionChange",function(h){return S(C),y(n.selected(h))}),s(60,We,4,4,"ng-container",22),e()()()(),o(61,"div",23)(62,"button",24),r(63,"Anterior"),e(),o(64,"button",25),r(65,"Siguiente"),e()()()(),o(66,"mat-step",26)(67,"div",17)(68,"form",9)(69,"div",27)(70,"mat-form-field",10)(71,"mat-label"),r(72,"N\xFAmero de factura"),e(),u(73,"input",28),e()(),o(74,"div",18)(75,"mat-form-field",10)(76,"mat-label"),r(77,"Valor"),e(),u(78,"input",29),s(79,ze,2,0,"mat-error",12)(80,Je,2,0,"mat-error",12),e(),o(81,"mat-form-field",10)(82,"mat-label"),r(83,"Cantidad de cuotas"),e(),u(84,"input",30),e()(),o(85,"div",18)(86,"mat-form-field",10)(87,"mat-label"),r(88,"Departamento"),e(),o(89,"mat-select",31,1),E("selectionChange",function(h){return S(C),y(n.getMunicipios(h))}),s(91,Ke,2,1,"ng-container",12),g(92,"async"),e()(),o(93,"mat-form-field",10)(94,"mat-label"),r(95,"Ciudad"),e(),o(96,"mat-select",11),s(97,Xe,2,1,"ng-container",12),g(98,"async"),e()()(),o(99,"div",18)(100,"mat-form-field",10)(101,"mat-label"),r(102,"Detalle compra"),e(),u(103,"textarea",32),e()()(),o(104,"div",23)(105,"button",24),r(106,"Anterior"),e(),o(107,"button",33),E("click",function(){return S(C),y(n.onSave())}),r(108,"Pagar"),e()()()(),o(109,"mat-step",34),s(110,Ye,48,11,"div",35),e()()()()()}l&2&&(t(4),G(" ","Detalle consumo"," "),t(),a("linear",!0),t(2),a("stepControl",n.firstFormGroup),t(2),a("formGroup",n.firstFormGroup),t(4),a("formControlName","idTipoDoc"),t(),a("ngIf",x(15,46,n.tiposDocumentos$)),t(2),a("ngIf",n.firstFormGroup.get("idTipoDoc").dirty||n.firstFormGroup.get("idTipoDoc").touched&&n.firstFormGroup.get("idTipoDoc").errors.required),t(4),a("formControlName","numDocumento"),t(),a("ngIf",n.firstFormGroup.get("numDocumento").dirty||n.firstFormGroup.get("numDocumento").touched&&n.firstFormGroup.get("numDocumento").errors.required),t(),a("ngIf",n.showAlert),t(),a("disabled",n.firstFormGroup.invalid)("ngClass",j(52,Re,n.firstFormGroup.valid,n.firstFormGroup.invalid)),t(2),a("stepControl",n.secondFormGroup),t(2),a("formGroup",n.secondFormGroup),t(5),a("formControlName","primerNombre")("disabled",!0),t(4),a("formControlName","segundoNombre")("disabled",!0),t(5),a("formControlName","primerApellido")("disabled",!0),t(4),a("formControlName","segundoApellido")("disabled",!0),t(5),a("formControlName","numDoc")("disabled",!0),t(4),a("formControlName","correo")("disabled",!0),t(5),a("formControlName","idCredito"),t(),a("ngForOf",n.creditos),t(4),a("disabled",n.secondFormGroup.invalid),t(2),a("stepControl",n.thirdFormGroup),t(2),a("formGroup",n.thirdFormGroup),t(5),a("formControlName","numeroFactura"),t(5),a("formControlName","montoConsumo")("mask","separator.0"),t(),a("ngIf",(n.montoConsumo.touched||n.montoConsumo.dirty)&&n.montoConsumo.hasError("required")),t(),a("ngIf",(n.montoConsumo.touched||n.montoConsumo.dirty)&&n.montoConsumo.hasError("notEqual")),t(4),a("min",1)("max",6)("formControlName","cantidadCuotas"),t(7),a("ngIf",x(92,48,n.departamentos$)),t(5),a("formControlName","idMunicipio"),t(),a("ngIf",x(98,50,n.municipios$)),t(6),a("formControlName","detalleCompra"),t(4),a("disabled",n.thirdFormGroup.invalid),t(2),a("stepControl",n.thirdFormGroup),t(),a("ngIf",n.detaleConsumo))},dependencies:[Ie,Ne,Ce,le,ne,de,ae,me,ce,ue,te,ge,Z,oe,ee,Ge,z,X,he,Q,W,ve,pe,se,Y,Te,be,J,w,T,L,De],data:{animation:re}});let i=m;return i})();function et(i){return m=>{let d=m.value;return console.log(i),d>i?{notEqual:!0}:null}}var kt=[{path:"",component:Me}];export{kt as default};
