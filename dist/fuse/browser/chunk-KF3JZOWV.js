import{a as f,b as F}from"./chunk-PEZYCTDT.js";import{a as oe,b as ie,c as ne}from"./chunk-JVMQGMWU.js";import{a as N}from"./chunk-5YZJEQ6Q.js";import{a as ee}from"./chunk-IWGHEBIZ.js";import{a as O,b as te}from"./chunk-2RSQTUPN.js";import{a as V}from"./chunk-OFEOPKCC.js";import"./chunk-KQASFADC.js";import"./chunk-CHOSRW5W.js";import{g as X}from"./chunk-QS2WZY2K.js";import"./chunk-JND367CQ.js";import{h as q}from"./chunk-7U4JZNVG.js";import{J as Y,i as J}from"./chunk-K2P4EKGI.js";import{ea as K,fa as Q,ja as R}from"./chunk-DARKUWJB.js";import"./chunk-EENLYY7H.js";import"./chunk-WGGS5SGH.js";import{b as Z,d as P,e as U}from"./chunk-DJAHQBBJ.js";import{g as A,j as I,l as E}from"./chunk-NP3GUERB.js";import{Cb as i,Db as n,Eb as g,Fb as v,Gb as _,Ib as D,Ob as S,Qb as p,Yb as l,Za as s,Zb as b,ac as B,bc as W,cc as z,dc as H,ec as M,fa as c,fc as $,ka as w,mc as T,nc as k,oc as L,pb as u,q as j,rb as d,ua as h,va as C}from"./chunk-32HXX3OB.js";import{a as G}from"./chunk-NEB6MB4Y.js";function me(t,r){if(t&1&&(v(0),g(1,"app-custom-table",16),_()),t&2){let e=p(2);s(),d("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons)}}function de(t,r){if(t&1&&u(0,me,2,5,"ng-container",15),t&2){let e=p();d("ngIf",e.data.length)}}function ce(t,r){if(t&1&&(v(0),g(1,"app-custom-table",16),_()),t&2){let e=p(2);s(),d("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons)}}function pe(t,r){if(t&1&&u(0,ce,2,5,"ng-container",15),t&2){let e=p();d("ngIf",e.data.length)}}function ue(t,r){if(t&1&&(v(0),g(1,"app-custom-table",16),_()),t&2){let e=p(2);s(),d("columns",e.columns)("displayedColumns",e.columns)("columnPropertyMap",e.columnPropertyMap)("data",e.data)("buttons",e.buttons)}}function fe(t,r){if(t&1&&u(0,ue,2,5,"ng-container",15),t&2){let e=p();d("ngIf",e.data.length)}}var ae=(()=>{let r=class r{constructor(){this.datePipe=c(I),this.currencyPipe=c(E),this.router=c(P),this.estadoService=c(V),this.consumoService=c(N),this.selectedTab=f.EN_REVISION,this.data=[],this.columns=["Fecha","N\xFAmero de factura","Detalle compra","Valor factura","Valor cuotas","Cantidad cuotas","Estado"],this.columnPropertyMap={Fecha:"fechaCreacion","N\xFAmero de factura":"numeroFactura","Detalle compra":"detalleCompra","Valor factura":"montoConsumo","Valor cuotas":"montoCuotas","Cantidad cuotas":"cantidadCuotas",Estado:"nombreEstadoCredito"},this.buttons=[{label:"View",icon:"visibility",action:a=>{console.log("Approve",a),this.selectedData=a,this.router.navigate(["pages/gestion-creditos/consumos/detalle",this.selectedData.id])}}],this.tabChanged=a=>{console.log("tabChangeEvent => ",a),console.log("index => ",a.index),this.tabIndex=a.index,console.log(this.tabIndex),this.selectedTab=a.index==0?f.EN_REVISION:a.index==1?f.APROBADA:a.index==2?f.RECHAZADA:f.EN_REVISION,this.getDetalle(this.selectedTab)}}listenGrid(){this.estadoService.stateGridSolicitudes.asObservable().subscribe(o=>{o.state&&(console.log("Si entro"),console.log(o),this.selectedTab=o.tab==0?f.EN_REVISION:o.tab==1?f.APROBADA:o.tab==2?f.RECHAZADA:f.EN_REVISION,this.tabIndex=o.tab,console.log(this.tabIndex),this.getDetalle(this.selectedTab))})}getDetalle(a){this.subcription$=this.consumoService.getDetalle(a).pipe(j(o=>(o.data.forEach(m=>{m.fechaCreacion=this.datePipe.transform(m.fechaCreacion,"dd/MM/yyyy"),m.montoConsumo=this.currencyPipe.transform(m.montoConsumo,"USD","symbol","1.2-2"),m.montoCuotas=this.currencyPipe.transform(m.montoCuotas,"USD","symbol","1.2-2")}),o))).subscribe(o=>{o?this.data=o.data:this.data=[]},o=>{this.data=[]})}ngOnDestroy(){this.subcription$.unsubscribe()}ngOnInit(){this.getDetalle(this.selectedTab),this.listenGrid()}};r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=w({type:r,selectors:[["app-grid-consumos"]],standalone:!0,features:[H([I,E]),M],decls:18,vars:6,consts:[["tabGroup",""],[1,"bg-card","flex","min-w-0","flex-auto","flex-col","dark:bg-transparent","sm:absolute","sm:inset-0","sm:overflow-hidden"],[1,"relative","flex","flex-0","flex-col","border-b","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-3xl","font-semibold","tracking-tight"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],[1,"fuse-mat-dense","rounded-lg","min-w-64",3,"subscriptSizing"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-auto","flex-col","overflow-hidden","sm:overflow-y-auto","bg-gray-100"],["mat-stretch-tabs","false",1,"sm:px-2",3,"selectedIndexChange","selectedTabChange","animationDuration","selectedIndex"],["label","En revisi\xF3n"],["matTabContent",""],["label","Aprobados"],["label","Rechazados"],[4,"ngIf"],[3,"columns","displayedColumns","columnPropertyMap","data","buttons"]],template:function(o,m){if(o&1){let x=D();i(0,"div",1)(1,"div",2)(2,"div",3),l(3,"Detalle Consumo"),n(),i(4,"div",4)(5,"mat-form-field",5),g(6,"mat-icon",6)(7,"input",7),n()()(),i(8,"div",8)(9,"div",9)(10,"mat-tab-group",10,0),z("selectedIndexChange",function(y){return h(x),W(m.tabIndex,y)||(m.tabIndex=y),C(y)}),S("selectedTabChange",function(y){return h(x),C(m.tabChanged(y))}),i(12,"mat-tab",11),u(13,de,1,1,"ng-template",12),n(),i(14,"mat-tab",13),u(15,pe,1,1,"ng-template",12),n(),i(16,"mat-tab",14),u(17,fe,1,1,"ng-template",12),n()()()()()}o&2&&(s(5),d("subscriptSizing","dynamic"),s(),d("svgIcon","heroicons_solid:magnifying-glass"),s(),d("autocomplete","off")("placeholder","Buscar"),s(3),d("animationDuration","500"),B("selectedIndex",m.tabIndex))},dependencies:[ee,J,R,Y,ie,oe,ne,A]});let t=r;return t})();var xe=()=>["/pages/gestion-creditos/consumos"];function ge(t,r){if(t&1&&(i(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"div")(5,"h3",15),l(6,"Fecha de compra"),n()(),i(7,"p",16),l(8),T(9,"date"),n()(),i(10,"div",14)(11,"div")(12,"h3",15),l(13,"N\xFAmero de factura"),n()(),i(14,"p",16),l(15),n()(),i(16,"div",14)(17,"div")(18,"h3",15),l(19,"Valor factura"),n(),i(20,"p",17),l(21,"Indica el valor en COP"),n()(),i(22,"p",16),l(23),T(24,"currency"),n()(),i(25,"div",18)(26,"p",15),l(27,"Valor cuota"),n(),i(28,"p",16),l(29),T(30,"currency"),n()(),i(31,"div",19)(32,"p",15),l(33,"Cantidad cuotas"),n(),i(34,"p",16),l(35),n()(),i(36,"div",20)(37,"p",15),l(38,"Detalle compra"),n(),i(39,"p",16),l(40),n()()()()()),t&2){let e=p(2);s(8),b(L(9,6,e.detalle.fechaCreacion,"dd/MM/yyyy")),s(7),b(e.detalle.numeroFactura),s(8),b(k(24,9,e.detalle.montoConsumo)),s(6),b(k(30,11,e.detalle.montoCuotas)),s(6),b(e.detalle.cantidadCuotas),s(5),b(e.detalle.detalleCompra)}}function be(t,r){if(t&1){let e=D();v(0),i(1,"div",21)(2,"button",22),S("click",function(){h(e);let o=p(2);return C(o.onReject())}),l(3," Rechazar "),n(),i(4,"button",23),S("click",function(){h(e);let o=p(2);return C(o.onSave())}),l(5," Aprobar "),n()(),_()}}function he(t,r){if(t&1&&(i(0,"div",8),u(1,ge,41,13,"div",9)(2,be,6,0,"ng-container",10),n()),t&2){let e=p();s(),d("ngIf",e.detalle),s(),d("ngIf",e.detalle.idEstadoCredito==e.CodigosDetalleConsumo.EN_REVISION)}}var re=(()=>{let r=class r{constructor(){this.toasService=c(te),this.fuseService=c(X),this.estadosDatosService=c(V),this.detalleConsumoService=c(N),this.activatedRoute=c(Z),this.router=c(P),this.idCredito="",this.CodigosDetalleConsumo=F}ngOnInit(){this.idCredito=this.activatedRoute.snapshot.paramMap.get("id"),this.getDetalle(this.idCredito)}getDetalle(a){this.subcription$=this.detalleConsumoService.getConsumo(a).subscribe(o=>{console.log(o),this.detalle=o.data})}onSave(){let a={idEstado:F.APROBADA,id:this.detalle.id};this.fuseService.open(G({},O)).afterClosed().subscribe(m=>{m==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(x=>{x.isExitoso&&(this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/consumos"]),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:0}))},x=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}onReject(){let a={idEstado:F.RECHAZADA,id:this.detalle.id};this.fuseService.open(G({},O)).afterClosed().subscribe(m=>{m==="confirmed"&&(this.subcription$=this.detalleConsumoService.patchConsumo(a).subscribe(x=>{x.isExitoso&&(this.toasService.toasAlertWarn({message:"Registro creado con exito!",actionMessage:"Cerrar",duration:3e3}),this.router.navigate(["/pages/gestion-creditos/consumos"]),this.estadosDatosService.stateGridSolicitudes.next({state:!0,tab:0}))},x=>{this.toasService.toasAlertWarn({message:"Ha ocurrido un error!!!!",actionMessage:"Cerrar",duration:3e3})}))})}};r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=w({type:r,selectors:[["app-form-consumos"]],standalone:!0,features:[M],decls:10,vars:4,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-auto","print:overflow-visible"],[1,"inline-block","p-6","sm:p-10","print:p-0","w-full"],[1,"bg-card","shadow","print:bg-transparent","print:p-0","print:shadow-none","rounded-2xl","max-w-xl","mx-auto","overflow-hidden"],[1,"bg-crediblue-50","px-6","py-4","flex","items-center","justify-between"],["mat-button","",1,"flex","items-center",3,"routerLink"],[1,"text-white",3,"svgIcon"],[1,"text-xl","font-bold","text-white"],["class","p-6",4,"ngIf"],[1,"p-6"],["class","w-full h-full px-4",4,"ngIf"],[4,"ngIf"],[1,"w-full","h-full","px-4"],[1,"max-w-2xl","mx-auto","p-4","bg-white","shadow-lg","rounded-lg"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","pb-2"],[1,"text-lg","font-semibold","text-gray-700"],[1,"text-lg","font-bold","text-gray-800"],[1,"text-sm","text-gray-500"],[1,"flex","justify-between","items-center"],[1,"flex","justify-between","items-center","pt-4","border-t"],[1,"flex","justify-between","items-center","border-t","pt-4"],[1,"flex","justify-end","items-center","mt-8","p-4"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediorange-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"],["mat-flat-button","",1,"fuse-mat-button-large","bg-crediblue-50","hover:bg-crediblue-100","text-white","font-semibold","py-2","px-4","rounded-lg","transition","duration-200",3,"click"]],template:function(o,m){o&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),g(6,"mat-icon",5),n()(),i(7,"h2",6),l(8,"Detalle consumo"),n()(),u(9,he,3,2,"div",7),n()()()),o&2&&(s(5),d("routerLink",$(3,xe)),s(),d("svgIcon","heroicons_outline:arrow-long-left"),s(3),d("ngIf",m.detalle))},dependencies:[q,E,I,Q,K,R,A,U]});let t=r;return t})();var Ke=[{path:"",component:ae},{path:"detalle/:id",component:re}];export{Ke as default};
